<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=US-ASCII" />
<title>
  File: IntroductionToRSpec
  
    &mdash; Documentation by YARD 0.8.7.4
  
</title>

  <link rel="stylesheet" href="css/style.css" type="text/css" charset="utf-8" />

  <link rel="stylesheet" href="css/common.css" type="text/css" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  hasFrames = window.top.frames.main ? true : false;
  relpath = '';
  framesUrl = "frames.html#!file.IntroductionToRSpec.html";
</script>


  <script type="text/javascript" charset="utf-8" src="js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="js/app.js"></script>


  </head>
  <body>
    <div id="header">
      <div id="menu">
  
    
        <a href="_index.html">Index</a> &raquo;
        
        <a href="file.Manual.html">RPicSim manual</a> &raquo;
    
    <span class="title">File: IntroductionToRSpec</span>
  

  <div class="noframes"><span class="title">(</span><a href="." target="_top">no frames</a><span class="title">)</span></div>
</div>

      <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="class_list.html">
      Class List
    </a>
  
    <a class="full_list_link" id="method_list_link"
        href="method_list.html">
      Method List
    </a>
  
    <a class="full_list_link" id="file_list_link"
        href="file_list.html">
      File List
    </a>
  
</div>
      <div class="clear"></div>
    </div>

    <iframe id="search_frame"></iframe>

    <div id="content"><div id='filecontents'>
<h1 id="label-Introduction+to+RSpec">Introduction to RSpec</h1>

<p><a href="http://rspec.info/">RSpec</a> is a testing tool for the Ruby
programming language that allows you to write an automated test suite.
RSpec provides great ways to combine code from similar tests, provides good
error messages, and encourages you to specify exactly what you are testing.</p>

<p>The main documentation for RSpec can be found from the project's website at
<a href="http://rspec.info/">rspec.info</a>. This page documents the most
important things you should know about RSpec.</p>

<h2 id="label-File+structure">File structure</h2>

<p>The recommended way to set up RSpec is to put your test suite in a
directory named <code>spec</code>, as discussed in the
<a href="file.QuickStartGuide.html" title="Quick-start guide">Quick-start guide</a>. When you run the
<code>rspec</code> command, RSpec will look for all the files in
<code>spec</code> and its subdirectories that have a name ending in
<code>_spec.rb</code>.</p>

<h2 id="label-Example+groups+and+examples">Example groups and examples</h2>

<p>Each spec file contains one or more <em>example groups</em>, which are
defined using RSpec's <code>describe</code> or <code>context</code>
commands. For example:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_describe'>describe</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>my device</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>do</span>
   <span class='comment'># examples of how your device should behave go here
</span><span class='kw'>end</span></code></pre>

<p>You can have nested example groups:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_describe'>describe</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>my device</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>do</span>
  <span class='id identifier rubyid_context'>context</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>when RA1 is held high</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>do</span>
    <span class='comment'># examples go here
</span>  <span class='kw'>end</span>
<span class='kw'>end</span></code></pre>

<p>The outer-most example group must be a <code>describe</code>, not a
<code>context</code>.</p>

<p>An <em>example</em> is the basic unit of an RSpec test suite. Examples are
defined using the <code>it</code> or <code>specify</code> commands inside
an example group:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_describe'>describe</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>my device</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>do</span>
  <span class='id identifier rubyid_it'>it</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>toggles RA2 often</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>do</span>
    <span class='comment'># code to test the toggling goes here
</span>  <span class='kw'>end</span>
<span class='kw'>end</span></code></pre>

<p>The strings passed to <code>describe</code>, <code>context</code>,
<code>it</code>, and <code>specify</code> are optional, but are used to
generate helpful error messages and documentation. If an example fails,
then a string about the expected behavior is produced by concatenating all
the provided strings, from outermost to innermost.</p>

<h2 id="label-Expectations">Expectations</h2>

<p>In general, an RSpec example consists of some code to set up the situation
being tested, and some code called an <em>expectation</em> that defines the
expected outcome. If an expectation fails, an exception is raised, the
example stops executing, and a failure message is displayed. Expectations
look like this:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_expect'>expect</span><span class='lparen'>(</span><span class='id identifier rubyid_something'>something</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to'>to</span> <span class='id identifier rubyid_have_some_property'>have_some_property</span>
<span class='id identifier rubyid_expect'>expect</span><span class='lparen'>(</span><span class='id identifier rubyid_something'>something</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to_not'>to_not</span> <span class='id identifier rubyid_have_some_property'>have_some_property</span></code></pre>
<ul><li>
<p><code>expect</code> is a method defined by RSpec which you can use inside
an example.</p>
</li><li>
<p><code>something</code> is the object being tested, which is usually the
output of the system under test or part of the system under test.</p>
</li><li>
<p><code>to</code> and <code>to_not</code> are special methods defined by
RSpec.</p>
</li><li>
<p><code>have_some_property</code> is a method call that returns a
<em>Matcher</em> object. The Matcher object decides whether the expectation
was met or not. In the example below, this method call is
<code>eq(6)</code>, which uses one of the <a
href="https://www.relishapp.com/rspec/rspec-expectations/docs/built-in-matchers">built-in
matcher types that RSpec provides</a>. Many RSpec examples only use
<code>eq</code> matchers.</p>
</li><li>
<p>Sometimes, as with <code>eq(6)</code>, you will pass arguments into the
methods that create matchers. Often these arguments represent expected
values, states, or properties being tested.</p>
</li></ul>

<p>Here is a concrete, runnable example:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_describe'>describe</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>the number 5</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>do</span>
  <span class='id identifier rubyid_it'>it</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>when added to one is six</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>do</span>
    <span class='id identifier rubyid_num'>num</span> <span class='op'>=</span> <span class='int'>1</span> <span class='op'>+</span> <span class='int'>5</span>
    <span class='id identifier rubyid_expect'>expect</span><span class='lparen'>(</span><span class='id identifier rubyid_num'>num</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to'>to</span> <span class='id identifier rubyid_eq'>eq</span> <span class='int'>6</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></code></pre>

<p>First, the code adds 1 to 5 and stores the result. Then the number 6 is
passed as the first argument to <code>eq</code>, making an equality matcher
that tests whether the result is equal to 6. Note that parentheses are not
required when calling a method in Ruby: you can write <code>eq(6)</code> or
<code>eq 6</code>.</p>

<p>A common practice in RSpec is to have just one expectation per example.
This helps you organize your examples and makes it clear to the reader what
each example is supposed to be testing. However, it is not always practical
because it makes the specs slower; there will be more examples and the code
that gets the system into the the situation to be tested has to be run more
times than necessary.</p>

<p>For more information, see the <a
href="https://www.relishapp.com/rspec/rspec-expectations/docs">RSpec
Expectations documentation</a>.</p>

<h2 id="label-Before+hooks">Before hooks</h2>

<p>Inside an example group, RSpec lets you define various kinds of
<em>hooks</em>. The only one we need for RPicSim is the <em>before
hook</em>. A before hook runs before each example in the example group. For
example:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_describe'>describe</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>my device</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>do</span>
  <span class='id identifier rubyid_before'>before</span> <span class='kw'>do</span>
    <span class='comment'># Code here runs before each example in this group.
</span>    <span class='comment'># This is equivalent to before(:each).
</span>  <span class='kw'>end</span>

  <span class='id identifier rubyid_specify'>specify</span> <span class='kw'>do</span>
    <span class='comment'># Code for example 1
</span>  <span class='kw'>end</span>

  <span class='id identifier rubyid_specify'>specify</span> <span class='kw'>do</span>
    <span class='comment'># Code for example 2
</span>  <span class='kw'>end</span>
<span class='kw'>end</span></code></pre>

<p>In RPicSim, you will usually have a before hook that starts the simulation
of your firmware.</p>

<p>If you have a context referring to your system being in a particular state,
a before hook is a great place for the code that actually gets the system
into that state. The code in that hook can easily be reused in multiple
examples that test different things about the state. For example:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_describe'>describe</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>my car</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>do</span>
  <span class='id identifier rubyid_context'>context</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>in second gear at 20 MPH</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>do</span>
    <span class='id identifier rubyid_before'>before</span> <span class='kw'>do</span>
      <span class='id identifier rubyid_car'>car</span><span class='period'>.</span><span class='id identifier rubyid_speed'>speed</span> <span class='op'>=</span> <span class='int'>20</span>
      <span class='id identifier rubyid_car'>car</span><span class='period'>.</span><span class='id identifier rubyid_gear'>gear</span> <span class='op'>=</span> <span class='int'>2</span>
    <span class='kw'>end</span>

    <span class='id identifier rubyid_it'>it</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>has a lot of torque</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>do</span>
      <span class='id identifier rubyid_expect'>expect</span><span class='lparen'>(</span><span class='id identifier rubyid_car'>car</span><span class='period'>.</span><span class='id identifier rubyid_torque'>torque</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to'>to</span> <span class='id identifier rubyid_eq'>eq</span> <span class='int'>7</span>
    <span class='kw'>end</span>

    <span class='id identifier rubyid_it'>it</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>has a high RPM</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>do</span>
      <span class='id identifier rubyid_expect'>expect</span><span class='lparen'>(</span><span class='id identifier rubyid_car'>car</span><span class='period'>.</span><span class='id identifier rubyid_rpm'>rpm</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to'>to</span> <span class='id identifier rubyid_eq'>eq</span> <span class='int'>9001</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></code></pre>

<h2 id="label-Instance+variables">Instance variables</h2>

<p>In Ruby, a variable whose name starts with <code>@</code> behaves specially
and is called an <em>instance variable</em>. Instance variables defined in
a before hook can be accessed in examples within the example group.</p>

<p>For example:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_describe'>describe</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>foo</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>do</span>
  <span class='id identifier rubyid_before'>before</span> <span class='kw'>do</span>
    <span class='ivar'>@car</span> <span class='op'>=</span> <span class='const'>Car</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
    <span class='ivar'>@wheel</span> <span class='op'>=</span> <span class='id identifier rubyid_car'>car</span><span class='period'>.</span><span class='id identifier rubyid_wheels'>wheels</span><span class='period'>.</span><span class='id identifier rubyid_find_by_location'>find_by_location</span><span class='lparen'>(</span><span class='symbol'>:front</span><span class='comma'>,</span> <span class='symbol'>:left</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_it'>it</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>is round</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>do</span>
    <span class='id identifier rubyid_expect'>expect</span><span class='lparen'>(</span><span class='ivar'>@wheel</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to'>to</span> <span class='id identifier rubyid_be_round'>be_round</span>
  <span class='kw'>end</span>

<span class='kw'>end</span></code></pre>

<h2 id="label-Let+variables">Let variables</h2>

<p>Another way to define a variable in RSpec is to use the <code>let</code>
syntax. The <code>let</code> method should be called inside an example
group. The first argument is the name of a variable to define. The
<code>let</code> method is passed a block that computes the value of the
variable, and the block will be called if the value of the variable is ever
needed. In other words, <code>let</code> variables are lazily evaluated.</p>

<p>The example below shows how a <code>let</code> variable could be useful for
making your tests more readable. In this case, <code>let</code> allows us
to separate the description of the expected behavior (the car can shift
gears) from the arbitrary value (2) that we used to test it.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_describe'>describe</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>my car</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>do</span>
  <span class='id identifier rubyid_let'>let</span><span class='lparen'>(</span><span class='symbol'>:gear</span><span class='rparen'>)</span> <span class='lbrace'>{</span> <span class='int'>2</span> <span class='rbrace'>}</span>

  <span class='id identifier rubyid_it'>it</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>can shift gears</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>do</span>
    <span class='id identifier rubyid_car'>car</span><span class='period'>.</span><span class='id identifier rubyid_gear'>gear</span> <span class='op'>=</span> <span class='id identifier rubyid_gear'>gear</span>
    <span class='id identifier rubyid_expect'>expect</span><span class='lparen'>(</span><span class='id identifier rubyid_car'>car</span><span class='period'>.</span><span class='id identifier rubyid_gear'>gear</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to'>to</span> <span class='id identifier rubyid_eq'>eq</span> <span class='id identifier rubyid_gear'>gear</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></code></pre>

<p>These <code>let</code> variables can also be a useful way to share data or
bits of code between different examples.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_describe'>describe</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>my car's front left wheel</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>do</span>
  <span class='id identifier rubyid_let'>let</span><span class='lparen'>(</span><span class='symbol'>:car</span><span class='rparen'>)</span> <span class='lbrace'>{</span> <span class='const'>Car</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span> <span class='rbrace'>}</span>
  <span class='id identifier rubyid_let'>let</span><span class='lparen'>(</span><span class='symbol'>:wheel</span><span class='rparen'>)</span> <span class='lbrace'>{</span> <span class='id identifier rubyid_car'>car</span><span class='period'>.</span><span class='id identifier rubyid_wheels'>wheels</span><span class='period'>.</span><span class='id identifier rubyid_find_by_location'>find_by_location</span><span class='lparen'>(</span><span class='symbol'>:front</span><span class='comma'>,</span> <span class='symbol'>:left</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span> <span class='rbrace'>}</span>

  <span class='id identifier rubyid_it'>it</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>is round</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>do</span>
    <span class='id identifier rubyid_expect'>expect</span><span class='lparen'>(</span><span class='id identifier rubyid_wheel'>wheel</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to'>to</span> <span class='id identifier rubyid_be_round'>be_round</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_it'>it</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>is a wheel</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>do</span>
    <span class='id identifier rubyid_expect'>expect</span><span class='lparen'>(</span><span class='id identifier rubyid_wheel'>wheel</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to'>to</span> <span class='id identifier rubyid_be_a_kind_of'>be_a_kind_of</span> <span class='const'>Car</span><span class='op'>::</span><span class='const'>Wheel</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></code></pre>

<h2 id="label-Blocks+in+RSpec">Blocks in RSpec</h2>

<p>Whenever you see code between the Ruby keywords <code>do</code> and
<code>end</code>, or between <code>{</code> and <code>}</code>, that code
is inside a Ruby <em>block</em>. A block is a chunk of executable code that
can be easily created, passed around, and called like a method.</p>

<p>In RSpec, the blocks you pass to the <code>describe</code> and
<code>context</code> methods are executed right away. However, the blocks
passed to the <code>it</code>, <code>specify</code>, <code>before</code>,
<code>after</code>, and <code>let</code> commands serve to define how the
examples will be executed, and those blocks do not get called until later
after RSpec has chosen which examples to run.</p>

<p>You cannot read a spec file like you would read a simple step-by-step
program. Any given block could be called once, multiple times, or never
depending on the situation.</p>

<h2 id="label-Shared+examples">Shared examples</h2>

<p>Sometimes you will be tempted to copy a set of examples from one context to
another, because the system should behave the same in both contexts.
However, your tests will be long and hard to maintain if you have too much
duplicated code. In this situation, you should consider making a <em>shared
example group</em>. See the <a
href="https://www.relishapp.com/rspec/rspec-core/docs/example-groups/shared-examples">RSpec
shared examples</a> documentation for more information.</p>
</div></div>

    <div id="footer">
  
    This is part of the <a href="file.Manual.html">RPicSim manual</a>.
  
  <br/><br/>

  Generated on Wed Sep 17 12:55:42 2014 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.8.7.4 (ruby-1.9.3).
</div>

  </body>
</html>