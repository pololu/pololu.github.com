<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Module: RPicSim::RSpec::PersistentExpectations
  
    &mdash; Documentation by YARD 0.9.19
  
</title>

  <link rel="stylesheet" href="../../css/style.css" type="text/css" charset="utf-8" />

  <link rel="stylesheet" href="../../css/common.css" type="text/css" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  pathId = "RPicSim::RSpec::PersistentExpectations";
  relpath = '../../';
</script>


  <script type="text/javascript" charset="utf-8" src="../../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../../js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="../../class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="../../_index.html">Index (P)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../../RPicSim.html" title="RPicSim (module)">RPicSim</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../RSpec.html" title="RPicSim::RSpec (module)">RSpec</a></span></span>
     &raquo; 
    <span class="title">PersistentExpectations</span>
  

  <div class="noframes"><span class="title">(</span><a href="." target="_top">no frames</a><span class="title">)</span></div>
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../../class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><h1>Module: RPicSim::RSpec::PersistentExpectations
  
  
  
</h1>
<div class="box_info">
  

  
  
  
  
  

  
  <dl>
    <dt>Included in:</dt>
    <dd><span class='object_link'><a href="Helpers.html" title="RPicSim::RSpec::Helpers (module)">Helpers</a></span></dd>
  </dl>
  

  
  <dl>
    <dt>Defined in:</dt>
    <dd>lib/rpicsim/rspec/persistent_expectations.rb</dd>
  </dl>
  
</div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    
<p>This simple module is included in <span class='object_link'><a href="Helpers.html" title="RPicSim::RSpec::Helpers (module)">Helpers</a></span> so it is
available in RSpec tests. It provides a way to set expectations on objects
that will be checked after every step of the simulation, so you can make
sure that the object stays in the state you are expecting it to.</p>

<p>Example:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_b'>b</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
<span class='id identifier rubyid_expecting'>expecting</span> <span class='id identifier rubyid_b'>b</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_satisfy'>satisfy</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_lb'>lb</span><span class='op'>|</span> <span class='id identifier rubyid_lb'>lb</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span> <span class='op'>&lt;</span> <span class='int'>10</span> <span class='rbrace'>}</span>
<span class='int'>20</span><span class='period'>.</span><span class='id identifier rubyid_times'>times</span> <span class='kw'>do</span>
  <span class='id identifier rubyid_b'>b</span> <span class='op'>&lt;&lt;</span> <span class='int'>0</span>
  <span class='id identifier rubyid_check_expectations'>check_expectations</span>  <span class='comment'># =&gt; raises an error once b has 10 elements
</span><span class='kw'>end</span>
</code></pre>

<p>For more information, see <a href="../../file.PersistentExpectations.html" title="PersistentExpectations">PersistentExpectations</a>.</p>


  </div>
</div>
<div class="tags">
  

</div>






  
    <h2>
      Instance Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#check_expectations-instance_method" title="#check_expectations (instance method)">#<strong>check_expectations</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Checks the expectations; if any object does not match its matcher then it
raises an error.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#expectations-instance_method" title="#expectations (instance method)">#<strong>expectations</strong>  &#x21d2; Hash </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the current set of persistent expectations.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#expecting-instance_method" title="#expecting (instance method)">#<strong>expecting</strong>(hash)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Adds or removes expectations.</p>
</div></span>
  
</li>

      
    </ul>
  



  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="check_expectations-instance_method">
  
    #<strong>check_expectations</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Checks the expectations; if any object does not match its matcher then it
raises an error.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


31
32
33
34
35
36</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rpicsim/rspec/persistent_expectations.rb', line 31</span>

<span class='kw'>def</span> <span class='id identifier rubyid_check_expectations'>check_expectations</span>
  <span class='id identifier rubyid_expectations'>expectations</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_subject'>subject</span><span class='comma'>,</span> <span class='id identifier rubyid_matcher'>matcher</span><span class='op'>|</span>
    <span class='id identifier rubyid_expect'>expect</span><span class='lparen'>(</span><span class='id identifier rubyid_subject'>subject</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to'>to</span> <span class='id identifier rubyid_matcher'>matcher</span> <span class='kw'>if</span> <span class='id identifier rubyid_matcher'>matcher</span>
  <span class='kw'>end</span>
  <span class='kw'>nil</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="expectations-instance_method">
  
    #<strong>expectations</strong>  &#x21d2; <tt>Hash</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the current set of persistent expectations. The keys are the
objects under test and the values are matchers that we expect to match the
object.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


25
26
27</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rpicsim/rspec/persistent_expectations.rb', line 25</span>

<span class='kw'>def</span> <span class='id identifier rubyid_expectations'>expectations</span>
  <span class='ivar'>@expectations</span> <span class='op'>||=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="expecting-instance_method">
  
    #<strong>expecting</strong>(hash)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Adds or removes expectations. The argument should be a hash that associates
objects to matchers. A matcher can be any bit of Ruby code that you would
be able write in RSpec in place of MATCHER in the code below:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_expect'>expect</span><span class='lparen'>(</span><span class='id identifier rubyid_object'>object</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to'>to</span> <span class='const'>MATCHER</span>
</code></pre>

<p>For example, you could do:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_expecting'>expecting</span> <span class='label'>main_output_pin:</span> <span class='id identifier rubyid_be_driving_high'>be_driving_high</span>
</code></pre>

<p>To remove an expectation on an object, just provide <code>nil</code> for
the matcher.</p>

<p>If given a block, applies the new expectations, executes the block, then
resets expectations to their former state. Expectation blocks may be nested
and freely mixed with other calls to `expecting`.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


55
56
57
58
59
60
61
62
63
64
65
66
67</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rpicsim/rspec/persistent_expectations.rb', line 55</span>

<span class='kw'>def</span> <span class='id identifier rubyid_expecting'>expecting</span><span class='lparen'>(</span><span class='id identifier rubyid_hash'>hash</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_block_given?'>block_given?</span>
    <span class='id identifier rubyid_saved_expectations'>saved_expectations</span> <span class='op'>=</span> <span class='id identifier rubyid_expectations'>expectations</span><span class='period'>.</span><span class='id identifier rubyid_clone'>clone</span>
    <span class='kw'>begin</span>
      <span class='id identifier rubyid_expecting'>expecting</span><span class='lparen'>(</span><span class='id identifier rubyid_hash'>hash</span><span class='rparen'>)</span>
      <span class='kw'>yield</span>
    <span class='kw'>ensure</span>
      <span class='ivar'>@expectations</span> <span class='op'>=</span> <span class='id identifier rubyid_saved_expectations'>saved_expectations</span>
    <span class='kw'>end</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_expectations'>expectations</span><span class='period'>.</span><span class='id identifier rubyid_merge!'>merge!</span> <span class='id identifier rubyid_hash'>hash</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

      <div id="footer">
  
  <br/><br/>

  Generated on Wed Apr 17 15:05:26 2019 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.19 (ruby-2.5.3).
</div>

    </div>
  </body>
</html>